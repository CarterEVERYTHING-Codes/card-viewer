<!DOCTYPE html>
<html>
<head>
  <link rel="icon" href="favicon.png" type="image/png">
  <title>Card Dashboard</title>
  <style>
  body {
    font-family: 'Josefin Sans', sans-serif;
    background-color: #121212; /* Dark background */
    color: #e0e0e0; /* Light text color */
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .dashboard-container {
    background-color: #1e1e1e; /* Darker container background */
    padding: 30px; /* Increased padding for spaciousness */
    border-radius: 12px; /* Smoother rounded corners */
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* Deeper shadow */
    width: 500px;
    max-width: 90%;
    text-align: left;
  }
  h2 {
    margin-top: 0;
    color: #00bfa5; /* Teal accent color */
    font-weight: 600; /* Slightly bolder heading */
    margin-bottom: 20px;
  }
  .section {
    margin-bottom: 30px; /* Increased spacing */
    border-bottom: 1px solid #333; /* Darker border */
    padding-bottom: 25px; /* Increased padding */
  }
  ul {
    list-style-type: none;
    padding: 0;
  }
  li {
    margin-bottom: 12px; /* Increased spacing */
    font-size: 1.1em; /* Slightly larger font */
  }
  button {
    background-color: #00bfa5; /* Teal accent color */
    color: #121212; /* Dark text on button */
    padding: 12px 20px; /* Larger padding */
    border: none;
    border-radius: 6px; /* Rounded corners */
    cursor: pointer;
    margin-top: 15px; /* Increased spacing */
    font-weight: 500; /* Slightly bolder button text */
    transition: background-color 0.3s ease; /* Smooth transition */
  }
  button:hover {
    background-color: #00897b; /* Darker teal on hover */
  }
  .balance-display {
    font-size: 2.5em; /* Larger balance font */
    font-weight: 600; /* Bolder balance font */
    text-align: center;
    margin-bottom: 25px; /* Increased spacing */
    color: #00bfa5;
  }
  #loadingWheel {
    text-align: center;
    margin-bottom: 30px;
    font-size: 1.2em; /* Larger loading text */
    color: #757575; /* Gray loading text */
  }
</style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="dashboard-container">
    <div id="loadingWheel" style="display: none;">Loading...</div>
    <h2 id="welcomeMessage">Welcome, Carter!</h2>
    <div id="balanceDisplay" class="balance-display"></div>
    <div class="section" id="cardDetailsSection">
      <h2>Card Details</h2>
      <ul id="cardDetails"></ul>
    </div>
    <div class="section" id="transactionsSection">
      <h2>Recent Transactions</h2>
      <ul id="transactionDetails"></ul>
    </div>
    <div class="section" id="securitySection">
      <h2>Security Options</h2>
      <button id="reportFraudButton">Report Fraud</button>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let cardData;

      function getCardIdFromUrl() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('cardId');
      }

      function displayCardDetails() {
        if (!cardData) {
          document.getElementById('cardDetails').innerHTML = '<li>Card data not available.</li>';
          document.getElementById('balanceDisplay').textContent = 'Balance: N/A';
          return;
        }

        let detailsHtml = `
          <li><strong>Card Number:</strong> ${cardData['Card Number:']}</li>
          <li><strong>Card Holder Name:</strong> ${cardData['Name on card:']}</li>
          <li><strong>Card Type:</strong> ${cardData['Type:']}</li>
        `;

        document.getElementById('cardDetails').innerHTML = detailsHtml;
        document.getElementById('balanceDisplay').textContent = `Balance: ${cardData['Card Balance:']} DigiCredits`;
      }

      function displayTransactions() {
        if (cardData) {
          let transactions = cardData['Purchases:'].split(', ');
          let transactionsHtml = '';

          transactions.forEach(transaction => {
            transactionsHtml += `
              <li>
                ${transaction}
                <button onclick="reportFraud()">Report Fraud</button>
              </li>
            `;
          });

          document.getElementById('transactionDetails').innerHTML = transactionsHtml;
        }
      }

      function reportFraud() {
        window.open('https://docs.google.com/forms/d/e/1FAIpQLScCV57H61VSOvd282C6YjE4dXThj382yFQN5r69MAYuLsZH5w/viewform?usp=header', '_blank');
      }

      function fetchCardData() {
        document.getElementById('loadingWheel').style.display = 'block';
        const cardId = getCardIdFromUrl();
        const sheetUrl = 'https://script.google.com/macros/s/AKfycbwI_d8Vx9sOuxqFlF-NXML6aoWj4JsXwRavkmvjR_P9Ho1wF2KYHfAeD6nSzcoPtiO4/exec'; // Replace with your actual URL
        fetch(sheetUrl)
          .then(response => response.json())
          .then(data => {
            document.getElementById('loadingWheel').style.display = 'none';
            console.log("Data from Google Apps Script:", data);
            cardData = data.find(item => item['Card Number:'] === cardId);
            if (cardData) {
              console.log("Card Data:", cardData);
              document.getElementById('welcomeMessage').textContent = `Welcome, ${cardData['Name on card:']}!`;
              displayCardDetails();
              displayTransactions();
            }
          })
          .catch(error => {
            document.getElementById('loadingWheel').style.display = 'none';
            console.error('Error fetching card data:', error);
            document.getElementById('cardDetails').innerHTML = '<li>Error loading card data.</li>';
            document.getElementById('balanceDisplay').textContent = 'Balance: N/A';
          });
      }

      fetchCardData();

      document.getElementById('reportFraudButton').addEventListener('click', reportFraud);
    });
  </script>
</body>
</html>
